# Hotel ç®¡ç†ç³»ç»Ÿ API æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°
é…’åº—è¡Œæç®¡ç†ç³»ç»Ÿï¼Œæä¾›å‘˜å·¥è®¤è¯å’Œè¡Œæç®¡ç†åŠŸèƒ½

## åŸºç¡€ä¿¡æ¯
- æœåŠ¡å™¨åœ°å€: http://localhost:8080
- è®¤è¯æ–¹å¼: JWT åŒä»¤ç‰Œè®¤è¯ (Access Token + Refresh Token)
- é™æµç­–ç•¥: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚
- æ•°æ®åº“: MySQL (studyæ•°æ®åº“)
- Goç‰ˆæœ¬: 1.25.3

## ğŸ” è®¤è¯ç›¸å…³ API

### 1. å‘˜å·¥æ³¨å†Œ
**POST** `/employee/register`
```json
è¯·æ±‚ä½“:
{
  "user": "zhangsan",         // ç”¨æˆ·åï¼ˆå¿…å¡«ï¼‰
  "password": "123456",       // å¯†ç ï¼ˆå¿…å¡«ï¼‰
  "name": "å¼ ä¸‰"              // å‘˜å·¥å§“åï¼ˆå¿…å¡«ï¼‰
}

å“åº”:
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "user": "zhangsan",
    "password": "123456"
  }
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "ç”¨æˆ·åå·²å­˜åœ¨" æˆ– "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}
```

### 2. å‘˜å·¥ç™»å½•
**POST** `/employee/login`
```json
è¯·æ±‚ä½“:
{
  "user": "zhangsan",         // ç”¨æˆ·å
  "password": "123456"        // å¯†ç 
}

å“åº”:
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 900,         // Access Token è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    "token_type": "Bearer"
  }
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "æ²¡æœ‰è¿™åå‘˜å·¥" æˆ– "ç™»å½•å¤±è´¥"
}
```

### 3. å‘˜å·¥é€€å‡º
**POST** `/employee/logout`
```json
è¯·æ±‚å¤´:
Authorization: Bearer <access_token>

å“åº”:
{
  "success": true,
  "message": "é€€å‡ºæˆåŠŸ"
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "tokenæ— æ•ˆ"
}
```

### 4. åˆ·æ–°ä»¤ç‰Œ
**POST** `/employee/refresh`
```json
è¯·æ±‚ä½“:
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

å“åº”:
{
  "success": true,
  "message": "tokenåˆ·æ–°æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 900,         // Access Token è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    "token_type": "Bearer"
  }
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "tokenæ— æ•ˆ"
}
```

## ğŸ§³ è¡Œæç®¡ç† API (éœ€è¦JWTè®¤è¯)

**è®¤è¯æ–¹å¼**: æ‰€æœ‰è¡Œæç®¡ç†APIéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«æœ‰æ•ˆçš„Access Token
```json
è¯·æ±‚å¤´æ ¼å¼:
Authorization: Bearer <access_token>
```

### 5. æ·»åŠ è¡Œæ
**POST** `/employee/add`
```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",      // å®¢æˆ·å§“åï¼ˆç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå®¢æˆ·è®°å½•ï¼‰
  "tag": "çº¢è‰²è¡Œæç®±",        // å¿…å¡«ï¼šè¡Œææ ‡ç­¾
  "weight": 15.5,           // å¯é€‰ï¼šè¡Œæé‡é‡
  "status": "å¯„å­˜ä¸­",        // å¯é€‰ï¼Œé»˜è®¤"å¯„å­˜ä¸­"
  "location": "å‰å°"         // å¯é€‰ï¼Œé»˜è®¤"å‰å°"
}

å“åº”:
{
  "success": true,
  "message": "è¡Œææ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,           // ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å®¢æˆ·ID
    "guest_name": "å¼ ä¸‰",
    "tag": "çº¢è‰²è¡Œæç®±",
    "weight": 15.5,
    "status": "å¯„å­˜ä¸­",
    "location": "å‰å°"
  }
}
```

### 6. åˆ é™¤è¡Œæ
**DELETE** `/employee/delete`
```json
è¯·æ±‚ä½“:
{
  "id": 1                    // å¿…å¡«ï¼šè¡ŒæID
}

å“åº”:
{
  "success": true,
  "message": "è¡Œæåˆ é™¤æˆåŠŸ"
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "è¡Œæè®°å½•ä¸å­˜åœ¨" æˆ– "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

æ³¨æ„:
- åªèƒ½åˆ é™¤çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
- åˆ é™¤æ“ä½œä¼šå…ˆå°†è¡ŒæçŠ¶æ€æ›´æ–°ä¸º"å·²å–å‡º"ï¼Œç„¶åè¿›è¡Œè½¯åˆ é™¤
- è½¯åˆ é™¤çš„è®°å½•ä¸ä¼šå‡ºç°åœ¨æ™®é€šæŸ¥è¯¢ä¸­ï¼Œä½†ä¼šåŒ…å«åœ¨ç»Ÿè®¡ä¸­
```

### 7. æ›´æ–°è¡Œæ
**PUT** `/employee/update`
```json
è¯·æ±‚ä½“:
{
  "id": 1,                    // å¿…å¡«ï¼šè¡ŒæID
  "status": "å·²å–å‡º",         // å¯é€‰ï¼šè¡ŒæçŠ¶æ€
  "location": "å·²å–å‡º",       // å¯é€‰ï¼šè¡Œæä½ç½®
  "tag": "æ–°æ ‡ç­¾",            // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "weight": 12.5              // å¯é€‰ï¼šè¡Œæé‡é‡
}

æˆåŠŸå“åº”:
{
  "success": true,
  "message": "è¡Œææ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,
    "guest_name": "å¼ ä¸‰",
    "tag": "æ–°æ ‡ç­¾",
    "weight": 12.5,
    "status": "å·²å–å‡º",
    "location": "å·²å–å‡º"
  }
}

å¤±è´¥å“åº”:
- è¡Œæè®°å½•ä¸å­˜åœ¨: {"success": false, "message": "è¡Œæè®°å½•ä¸å­˜åœ¨"}
- æœªæä¾›è¡ŒæID: {"success": false, "message": "è¯·æä¾›è¡ŒæID"}
- æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°: {"success": false, "message": "æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°"}
- è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯: {"success": false, "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"}
```

### 8. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å®¢æˆ·å§“åï¼‰
**GET** `/employee/get/name?guest_name=å¼ ä¸‰`
```
è¯·æ±‚å‚æ•°:
- guest_name: å®¢æˆ·å§“åï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    },
    {
      "id": 2,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "é»‘è‰²èƒŒåŒ…",
      "weight": 8.2,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 2
}

æ³¨æ„:
- åªè¿”å›çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
- å·²å–å‡ºçš„è¡Œæä¸ä¼šå‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­
- è¿”å›æ•°æ®å·²æ’é™¤ç³»ç»Ÿæ—¶é—´å­—æ®µï¼ˆcreated_at, updated_at, deleted_atï¼‰
```

### 9. æŸ¥è¯¢æ‰€æœ‰è¡Œæ
**GET** `/employee/get/all`
```
å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    },
    {
      "id": 3,
      "guest_id": 2,
      "guest_name": "æå››",
      "tag": "è“è‰²æ‰‹æç®±",
      "weight": 10.0,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 2
}

æ³¨æ„:
- è¿”å›æ‰€æœ‰çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
- è¿”å›æ•°æ®å·²æ’é™¤ç³»ç»Ÿæ—¶é—´å­—æ®µ
```

### 10. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å®¢æˆ·IDï¼‰
**GET** `/employee/get/guest_id?guest_id=1`
```
è¯·æ±‚å‚æ•°:
- guest_id: å®¢æˆ·IDï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}

æ³¨æ„:
- åªè¿”å›çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
```

### 11. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å­˜æ”¾ä½ç½®ï¼‰
**GET** `/employee/get/location?location=å‰å°`
```
è¯·æ±‚å‚æ•°:
- location: å­˜æ”¾ä½ç½®ï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}
```

### 12. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰çŠ¶æ€ï¼‰
**GET** `/employee/get/status?status=å¯„å­˜ä¸­`
```
è¯·æ±‚å‚æ•°:
- status: è¡ŒæçŠ¶æ€ï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}
```

æ³¨æ„:
- å¯ä»¥æŸ¥è¯¢ä»»æ„çŠ¶æ€çš„è¡Œæè®°å½•ï¼Œä¸é™åˆ¶ä¸º"å¯„å­˜ä¸­"
- æ”¯æŒæŸ¥è¯¢"å¯„å­˜ä¸­"ã€"å·²å–å‡º"ç­‰æ‰€æœ‰çŠ¶æ€
```

### 13. é«˜çº§æŸ¥è¯¢ï¼ˆå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼‰
**POST** `/employee/get/guest_advance`
```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",      // å¯é€‰ï¼šå®¢æˆ·å§“å
  "guest_id": 1,             // å¯é€‰ï¼šå®¢æˆ·ID
  "tag": "çº¢è‰²è¡Œæç®±",        // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "weight": 15.5,            // å¯é€‰ï¼šè¡Œæé‡é‡
  "location": "å‰å°",         // å¯é€‰ï¼šå­˜æ”¾ä½ç½®
  "status": "å¯„å­˜ä¸­"          // å¯é€‰ï¼šè¡ŒæçŠ¶æ€ï¼Œé»˜è®¤ä¸º"å¯„å­˜ä¸­"
}

å“åº”:
{
  "success": true,
  "message": "è·å–è¡ŒææˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}

è¯´æ˜:
- æ”¯æŒå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼Œåªæœ‰éç©ºå­—æ®µæ‰ä¼šä½œä¸ºæŸ¥è¯¢æ¡ä»¶
- å¦‚æœä¸æŒ‡å®šstatusï¼Œé»˜è®¤æŸ¥è¯¢çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
- æ‰€æœ‰æ¡ä»¶éƒ½æ˜¯ANDå…³ç³»
- é€‚ç”¨äºå¤æ‚çš„æœç´¢åœºæ™¯
```

## ğŸ“Š ç»Ÿè®¡åŠŸèƒ½ API (éœ€è¦JWTè®¤è¯)

**è®¤è¯æ–¹å¼**: æ‰€æœ‰ç»Ÿè®¡åŠŸèƒ½APIéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«æœ‰æ•ˆçš„Access Token
```json
è¯·æ±‚å¤´æ ¼å¼:
Authorization: Bearer <access_token>
```

### 14. è·å–æ€»è¡Œææ•°é‡
**GET** `/employee/count/sum`
```
å“åº”:
{
  "success": true,
  "message": "è¡Œææ•°é‡è·å–æˆåŠŸ",
  "count": 25
}

è¯´æ˜:
- åªç»Ÿè®¡çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œææ•°é‡
- ä¸åŒ…å«å·²å–å‡ºæˆ–å·²åˆ é™¤çš„è¡Œæ
```

### 15. è·å–ä»Šæ—¥è¡Œæç»Ÿè®¡
**GET** `/employee/count/today`
```
å“åº”:
{
  "success": true,
  "message": "è·å–ä»Šæ—¥ç»Ÿè®¡æˆåŠŸ",
  "data": {
    "date": "2025-11-17",
    "today_added": 8,    // ä»Šæ—¥æ–°å¢è¡Œææ•°é‡
    "today_taken": 3      // ä»Šæ—¥å–å‡ºè¡Œææ•°é‡
  }
}

è¯´æ˜:
- today_added: ä»Šæ—¥åˆ›å»ºçš„è¡Œæè®°å½•æ•°é‡
- today_taken: ä»Šæ—¥çŠ¶æ€æ›´æ–°ä¸º"å·²å–å‡º"çš„è¡Œææ•°é‡
- åŒ…å«è½¯åˆ é™¤çš„è®°å½•ç»Ÿè®¡
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### Employee (å‘˜å·¥è¡¨)
```go
type Employee struct {
    ID       uint   `gorm:"primaryKey;autoIncrement;type:int unsigned"`
    Name     string `json:"name" gorm:"column:name"`
    User     string `json:"user" gorm:"column:user"`
    Password string `json:"password" gorm:"column:password"`
}
```

### Luggage (è¡Œæè¡¨)
```go
type Luggage struct {
    ID        uint           `gorm:"primaryKey;autoIncrement"`
    GuestID   uint           `json:"guest_id" gorm:"column:guest_id"`
    Tag       string         `json:"tag" gorm:"column:tag;size:50"`
    Weight    float32        `json:"weight" gorm:"column:weight"`
    Status    string         `json:"status" gorm:"column:status;size:20"`
    Location  string         `json:"location" gorm:"column:location;size:100"`
    CreatedAt time.Time      `json:"-"`
    UpdatedAt time.Time      `json:"-"`
    DeletedAt gorm.DeletedAt `gorm:"index" json:"-"`
    Guest    Guest           `gorm:"foreignKey:GuestID"`
}
```

### Guest (å®¢æˆ·è¡¨)
```go
type Guest struct {
    ID   uint   `gorm:"primaryKey;autoIncrement;type:int unsigned"`
    Name string `json:"name" gorm:"column:guest_name"`
}
```

### RefreshToken (åˆ·æ–°ä»¤ç‰Œè¡¨)
```go
type RefreshToken struct {
    UserID    uint      `json:"user_id" gorm:"primaryKey"`
    UserName  string    `json:"user_name" gorm:"column:user_name"`
    Token     string    `json:"token" gorm:"column:token;size:255"`
    CreatedAt time.Time `json:"-"`
}
```

## ğŸ”— æ•°æ®åº“å…³ç³»è¯´æ˜

### å¤–é”®å…³è”
- `Luggage.guest_id` â†’ `Guest.id` (ä¸€å¯¹å¤šå…³ç³»)
- ä¸€ä¸ªå®¢æˆ·å¯ä»¥æœ‰å¤šä¸ªè¡Œæè®°å½•
- å®¢æˆ·å§“ååªå­˜å‚¨åœ¨Guestè¡¨ä¸­ï¼Œé¿å…æ•°æ®å†—ä½™

### æŸ¥è¯¢ä¼˜åŒ–
- ä½¿ç”¨GORMçš„PreloadåŠŸèƒ½è¿›è¡Œå…³è”æŸ¥è¯¢
- æ”¯æŒJOINæŸ¥è¯¢è·å–å®Œæ•´çš„å®¢æˆ·ä¿¡æ¯
- æŸ¥è¯¢æ—¶è‡ªåŠ¨åŠ è½½å…³è”çš„Guestæ•°æ®

### æ•°æ®åº“è®¾è®¡åŸåˆ™
- **é¿å…æ•°æ®å†—ä½™**: å®¢æˆ·å§“ååªåœ¨Guestè¡¨ä¸­å­˜å‚¨ä¸€ä»½
- **ä¿è¯æ•°æ®ä¸€è‡´æ€§**: é€šè¿‡å¤–é”®çº¦æŸç¡®ä¿å¼•ç”¨å®Œæ•´æ€§
- **æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨Preloadé¿å…N+1æŸ¥è¯¢é—®é¢˜
- **è¡¨åè§„èŒƒ**: éµå¾ªGORMé»˜è®¤çš„å¤æ•°è¡¨åå‘½åè§„åˆ™

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **JWTåŒä»¤ç‰Œè®¤è¯**: 
   - Access Token: 15åˆ†é’Ÿæœ‰æ•ˆæœŸï¼Œç”¨äºAPIè®¿é—®
   - Refresh Token: 7å¤©æœ‰æ•ˆæœŸï¼Œç”¨äºåˆ·æ–°Access Token
2. **ä»¤ç‰ŒéªŒè¯**: è‡ªåŠ¨éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§å’Œç”¨æˆ·èº«ä»½
3. **æƒé™æ§åˆ¶**: è¡Œææ“ä½œéœ€è¦æœ‰æ•ˆçš„JWTä»¤ç‰Œ
4. **é™æµä¿æŠ¤**: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚
5. **ä»¤ç‰Œæ’¤é”€**: ç™»å‡ºæ—¶è‡ªåŠ¨æ’¤é”€åˆ·æ–°ä»¤ç‰Œ
6. **åŒé‡ä¸­é—´ä»¶**: JwtCheck()åŸºç¡€éªŒè¯ + AuthCheck()æƒé™æ£€æŸ¥
7. **å¯†é’¥åˆ†ç¦»**: Access Tokenå’ŒRefresh Tokenä½¿ç”¨ä¸åŒçš„ç­¾åå¯†é’¥

## ğŸ“ˆ çŠ¶æ€ç è¯´æ˜

- `200`: æ“ä½œæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªè®¤è¯æˆ–ä»¤ç‰Œæ— æ•ˆ/è¿‡æœŸ
- `403`: æƒé™ä¸è¶³
- `404`: èµ„æºæœªæ‰¾åˆ°
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸš€ å¯åŠ¨æ–¹å¼

```bash
cd c:/Users/å‚…ä»æ°/Desktop/hotel
# ç¡®ä¿æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®
go run server/main.go
```

æœåŠ¡å™¨å°†åœ¨ `http://0.0.0.0:8080` å¯åŠ¨ï¼Œæ”¯æŒæœ¬åœ°å’Œç½‘ç»œè®¿é—®ã€‚

## ğŸ“‹ è·¯ç”±ç»“æ„

æ ¹æ® `main.go` çš„å®é™…é…ç½®ï¼ŒAPIè·¯ç”±ç»“æ„å¦‚ä¸‹ï¼š

```
/employee
â”œâ”€â”€ POST /register          # å‘˜å·¥æ³¨å†Œï¼ˆæ— éœ€è®¤è¯ï¼‰
â”œâ”€â”€ POST /login             # å‘˜å·¥ç™»å½•ï¼ˆæ— éœ€è®¤è¯ï¼‰
â””â”€â”€ /                      # éœ€è¦JWTè®¤è¯çš„è·¯ç”±ç»„
    â”œâ”€â”€ POST /refresh       # åˆ·æ–°ä»¤ç‰Œ
    â”œâ”€â”€ POST /logout        # å‘˜å·¥é€€å‡º
    â”œâ”€â”€ POST /add           # æ·»åŠ è¡Œæ
    â”œâ”€â”€ DELETE /delete      # åˆ é™¤è¡Œæ
    â”œâ”€â”€ PUT /update        # æ›´æ–°è¡Œæ
    â”œâ”€â”€ GET /get
    â”‚   â”œâ”€â”€ /name          # æŒ‰å®¢æˆ·å§“åæŸ¥è¯¢
    â”‚   â”œâ”€â”€ /all           # æŸ¥è¯¢æ‰€æœ‰è¡Œæ
    â”‚   â”œâ”€â”€ /guest_id      # æŒ‰å®¢æˆ·IDæŸ¥è¯¢
    â”‚   â”œâ”€â”€ /location      # æŒ‰å­˜æ”¾ä½ç½®æŸ¥è¯¢
    â”‚   â”œâ”€â”€ /status        # æŒ‰çŠ¶æ€æŸ¥è¯¢
    â”‚   â””â”€â”€ POST /guest_advance  # é«˜çº§æŸ¥è¯¢
    â””â”€â”€ GET /count
        â”œâ”€â”€ /sum           # è·å–æ€»è¡Œææ•°é‡
        â””â”€â”€ /today         # è·å–ä»Šæ—¥ç»Ÿè®¡
```

## ğŸ”’ è®¤è¯ä¸­é—´ä»¶

ç³»ç»Ÿä½¿ç”¨ä¸¤å±‚è®¤è¯ä¸­é—´ä»¶ï¼š
1. **JwtCheck()**: åŸºç¡€JWTä»¤ç‰ŒéªŒè¯
2. **AuthCheck()**: é¢å¤–çš„æƒé™æ£€æŸ¥ï¼ˆç”¨äºå¤§éƒ¨åˆ†ä¸šåŠ¡æ¥å£ï¼‰

## âš¡ é™æµé…ç½®

- ä»¤ç‰Œæ¡¶é™æµå™¨ï¼š100ä¸ªä»¤ç‰Œ/ç§’
- æ¯ä¸ªè¯·æ±‚æ¶ˆè€—1ä¸ªä»¤ç‰Œ
- è¶…å‡ºé™åˆ¶è¿”å›429çŠ¶æ€ç 

## ğŸ“ é¡¹ç›®ç»“æ„

```
hotel/
â”œâ”€â”€ server/main.go                    # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ models/struct.go                  # æ•°æ®æ¨¡å‹å®šä¹‰
â”œâ”€â”€ services/services.go              # æ•°æ®åº“è¿æ¥æœåŠ¡
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ employee_check/employee_check.go  # å‘˜å·¥è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ employee_action/employee_action.go # è¡Œææ“ä½œé€»è¾‘
â”‚   â”œâ”€â”€ middleware/middleware.go          # ä¸­é—´ä»¶ï¼ˆJWTã€é™æµï¼‰
â”‚   â”œâ”€â”€ util/util.go                      # JWTå·¥å…·å‡½æ•°
â”‚   â””â”€â”€ table/table.go                    # æ•°æ®åº“è¡¨åˆ›å»º
â”œâ”€â”€ go.mod                            # ä¾èµ–ç®¡ç†
â”œâ”€â”€ go.sum                            # ä¾èµ–ç‰ˆæœ¬é”å®š
â”œâ”€â”€ api_documentation.txt             # APIæ–‡æ¡£
â””â”€â”€ Hotel è¡Œæç®¡ç†ç³»ç»Ÿ API.openapi.json # OpenAPIè§„èŒƒæ–‡æ¡£
```

## ğŸ’¡ ä½¿ç”¨è¯´æ˜

1. å…ˆå¯åŠ¨æœåŠ¡å™¨
2. æ³¨å†Œå‘˜å·¥è´¦å·
3. ç™»å½•è·å–JWTåŒä»¤ç‰Œ
4. ä½¿ç”¨Access Tokenè®¿é—®API
5. Tokenè¿‡æœŸæ—¶ä½¿ç”¨Refresh Tokenåˆ·æ–°
6. ç™»å‡ºæ—¶æ’¤é”€æ‰€æœ‰ä»¤ç‰Œ

## ğŸ”§ JWTä»¤ç‰Œä½¿ç”¨ç¤ºä¾‹

### JavaScript/å‰ç«¯ç¤ºä¾‹
```javascript
// ç™»å½•è·å–ä»¤ç‰Œ
const loginResponse = await fetch('/employee/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ user_name: 'zhangsan', password: '123456' })
});
const { data } = await loginResponse.json();
localStorage.setItem('access_token', data.access_token);
localStorage.setItem('refresh_token', data.refresh_token);

// ä½¿ç”¨Access Tokenè®¿é—®API
const apiCall = await fetch('/employee/add', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${localStorage.getItem('access_token')}`
  },
  body: JSON.stringify({ guest_name: 'å¼ ä¸‰', tag: 'çº¢è‰²è¡Œæç®±' })
});

// åˆ·æ–°ä»¤ç‰Œ
const refreshResponse = await fetch('/employee/refresh', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ refresh_token: localStorage.getItem('refresh_token') })
});
const { data: newData } = await refreshResponse.json();
localStorage.setItem('access_token', newData.access_token);
```

---
æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2025-11-24
é¡¹ç›®ç‰ˆæœ¬: 2.2.0

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v2.2.0 (2025-11-24)
- ğŸ“š **æ–‡æ¡£å…¨é¢æ›´æ–°**: åŸºäºå®é™…ä»£ç å®Œå…¨é‡å†™APIæ–‡æ¡£
- ğŸ”§ **å­—æ®µç²¾ç¡®åŒ¹é…**: æ‰€æœ‰æ¥å£å­—æ®µå®šä¹‰ä¸ä»£ç å®ç°å®Œå…¨ä¸€è‡´
- ğŸ“ **æ•°æ®æ¨¡å‹æ›´æ–°**: ä½¿ç”¨Goç»“æ„ä½“å®šä¹‰å±•ç¤ºçœŸå®æ•°æ®æ¨¡å‹
- ğŸ—ï¸ **é¡¹ç›®ç»“æ„å®Œå–„**: è¯¦ç»†å±•ç¤ºå®Œæ•´çš„é¡¹ç›®ç›®å½•ç»“æ„
- ğŸ” **å®‰å…¨ç‰¹æ€§å¢å¼º**: è¡¥å……JWTå¯†é’¥åˆ†ç¦»å’ŒåŒé‡ä¸­é—´ä»¶è¯´æ˜
- ğŸ“Š **ä¾èµ–ä¿¡æ¯**: æ·»åŠ Goç‰ˆæœ¬å’Œä¸»è¦ä¾èµ–åŒ…ä¿¡æ¯
- âœ… **æ¥å£éªŒè¯**: æ‰€æœ‰APIæ¥å£æè¿°ç»è¿‡å®é™…ä»£ç éªŒè¯

### v2.1.1 (2025-11-21)
- ğŸ”§ **æ¥å£æ–‡æ¡£ä¿®å¤**: ä¿®å¤åˆ é™¤å’Œæ›´æ–°æ¥å£çš„è¯·æ±‚ä½“å­—æ®µå®šä¹‰
- ğŸ“ **å­—æ®µåŒ¹é…**: ç¡®ä¿æ‰€æœ‰æ¥å£å­—æ®µä¸å®é™…ä»£ç å®Œå…¨åŒ¹é…
- âœ… **çŠ¶æ€æŸ¥è¯¢ä¿®æ­£**: ä¿®æ­£GetStatusæ¥å£çš„æè¿°ï¼Œæ”¯æŒæŸ¥è¯¢ä»»æ„çŠ¶æ€
- ğŸ”„ **è¯·æ±‚ä½“å®Œå–„**: åˆ é™¤å’Œæ›´æ–°æ¥å£æ”¯æŒå®Œæ•´çš„Luggageç»“æ„ä½“å­—æ®µ
- ğŸ“š **æ–‡æ¡£åŒæ­¥**: æ–‡æ¡£ä¸ä»£ç å®ç°ä¿æŒå®Œå…¨ä¸€è‡´

### v2.1.0 (2025-11-21)
- ğŸ”§ **æ³¨å†ŒåŠŸèƒ½ä¿®å¤**: ä¿®å¤é‡å¤ç”¨æˆ·åæ£€æŸ¥é€»è¾‘é”™è¯¯
- ğŸ“ **å­—æ®µå®Œå–„**: æ³¨å†Œæ¥å£æ–°å¢nameå­—æ®µï¼Œæ”¯æŒå‘˜å·¥å§“å
- âœ… **éªŒè¯å¢å¼º**: å®Œå–„æ³¨å†Œæ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸ”„ **å“åº”ä¼˜åŒ–**: æ³¨å†ŒæˆåŠŸåè¿”å›å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯
- ğŸ›¡ï¸ **å®‰å…¨æ€§æå‡**: ä¿®å¤ç”¨æˆ·IDå¯èƒ½ä¸º0çš„å®‰å…¨éšæ‚£

### v2.0.0 (2025-11-20)
- ğŸ” **JWTåŒä»¤ç‰Œè®¤è¯**: å…¨é¢å‡çº§è®¤è¯ç³»ç»Ÿï¼Œä½¿ç”¨Access Token + Refresh Token
- ğŸ›¡ï¸ **å®‰å…¨æ€§æå‡**: æ›¿æ¢Sessionè®¤è¯ï¼Œæä¾›æ›´å®‰å…¨çš„æ— çŠ¶æ€è®¤è¯
- â° **ä»¤ç‰Œç®¡ç†**: Access Token 15åˆ†é’Ÿè¿‡æœŸï¼ŒRefresh Token 7å¤©æœ‰æ•ˆæœŸ
- ğŸ”„ **è‡ªåŠ¨åˆ·æ–°**: æ”¯æŒä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- ğŸš« **ä»¤ç‰Œæ’¤é”€**: ç™»å‡ºæ—¶è‡ªåŠ¨æ’¤é”€åˆ·æ–°ä»¤ç‰Œ
- ğŸ“± **å‰ç«¯å‹å¥½**: æä¾›å®Œæ•´çš„JavaScriptä½¿ç”¨ç¤ºä¾‹
- ğŸ”§ **ä¸­é—´ä»¶å‡çº§**: æ–°å¢JWTè®¤è¯ä¸­é—´ä»¶ï¼Œè‡ªåŠ¨éªŒè¯ä»¤ç‰Œ

### v1.4.0 (2025-11-19)
- ğŸ”§ **æ•°æ®åº“ç»“æ„ä¼˜åŒ–**: ç§»é™¤Luggageè¡¨ä¸­çš„å†—ä½™GuestNameå­—æ®µ
- ğŸ”— **å¤–é”®å…³è”**: ä½¿ç”¨æ ‡å‡†çš„å¤–é”®å…³ç³»è¿æ¥Luggageå’ŒGuestè¡¨
- âš¡ **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨GORM PreloadåŠŸèƒ½æ›¿ä»£æ‰‹åŠ¨JOINæŸ¥è¯¢
- ğŸ› **è¡¨åä¿®æ­£**: ä¿®å¤æŸ¥è¯¢ä¸­çš„è¡¨åé”™è¯¯ï¼ˆluggage â†’ luggagesï¼‰
- ğŸ“Š **å…³è”æŸ¥è¯¢**: æ”¯æŒé€šè¿‡å®¢æˆ·å§“åæŸ¥è¯¢æ—¶è‡ªåŠ¨å…³è”å®¢æˆ·ä¿¡æ¯
- ğŸ›¡ï¸ **æ•°æ®ä¸€è‡´æ€§**: å®¢æˆ·å§“åç»Ÿä¸€å­˜å‚¨ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´é—®é¢˜

### v1.3.0 (2025-11-17)
- âœ… æ–°å¢æŒ‰å®¢æˆ·IDæŸ¥è¯¢è¡ŒæåŠŸèƒ½
- âœ… æ–°å¢æŒ‰å­˜æ”¾ä½ç½®æŸ¥è¯¢è¡ŒæåŠŸèƒ½  
- âœ… æ–°å¢æŒ‰çŠ¶æ€æŸ¥è¯¢è¡ŒæåŠŸèƒ½
- âœ… æ–°å¢é«˜çº§å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢åŠŸèƒ½
- âœ… å®Œå–„APIå“åº”çŠ¶æ€ç è¯´æ˜
- âœ… ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘ï¼Œæ”¯æŒåŠ¨æ€æ¡ä»¶æ„å»º

### v1.2.0
- âœ… å®Œå–„åŸºç¡€CRUDåŠŸèƒ½
- âœ… æ·»åŠ ç»Ÿè®¡åŠŸèƒ½
- âœ… å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶