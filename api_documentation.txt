# Hotel ç®¡ç†ç³»ç»Ÿ API æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°
é…’åº—è¡Œæç®¡ç†ç³»ç»Ÿï¼Œæä¾›å‘˜å·¥è®¤è¯å’Œè¡Œæç®¡ç†åŠŸèƒ½

## åŸºç¡€ä¿¡æ¯
- æœåŠ¡å™¨åœ°å€: http://localhost:8080
- è®¤è¯æ–¹å¼: Session ä¼šè¯ç®¡ç†
- é™æµç­–ç•¥: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚

## ğŸ” è®¤è¯ç›¸å…³ API

### 1. å‘˜å·¥æ³¨å†Œ
**POST** `/employee/register`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan",    // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
  "password": "123456"
}

å“åº”:
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

### 2. å‘˜å·¥ç™»å½•
**POST** `/employee/login`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan",     // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
  "password": "123456"
}

å“åº”:
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ"
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "æ²¡æœ‰è¿™åå‘˜å·¥" æˆ– "ç™»å½•å¤±è´¥"
}
```

### 3. å‘˜å·¥é€€å‡º
**POST** `/employee/logout`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan"      // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
}

å“åº”:
{
  "success": true,
  "message": "é€€å‡ºæˆåŠŸ"
}
```

## ğŸ§³ è¡Œæç®¡ç† API (éœ€è¦ç™»å½•)

### 4. æ·»åŠ è¡Œæ
**POST** `/employee/add`
```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",      // å®¢æˆ·å§“åï¼ˆç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå®¢æˆ·è®°å½•ï¼‰
  "tag": "çº¢è‰²è¡Œæç®±",        // å¿…å¡«ï¼šè¡Œææ ‡ç­¾
  "weight": 15.5,           // å¯é€‰ï¼šè¡Œæé‡é‡
  "status": "å¯„å­˜ä¸­",        // å¯é€‰ï¼Œé»˜è®¤"å¯„å­˜ä¸­"
  "location": "å‰å°"         // å¯é€‰ï¼Œé»˜è®¤"å‰å°"
}

å“åº”:
{
  "success": true,
  "message": "è¡Œææ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,           // ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å®¢æˆ·ID
    "guest_name": "å¼ ä¸‰",
    "tag": "çº¢è‰²è¡Œæç®±",
    "weight": 15.5,
    "status": "å¯„å­˜ä¸­",
    "location": "å‰å°"
  }
}
```

### 5. åˆ é™¤è¡Œæ
**DELETE** `/employee/delete`
```json
è¯·æ±‚ä½“:
{
  "id": 1
}

å“åº”:
{
  "success": true,
  "message": "è¡Œæåˆ é™¤æˆåŠŸ"
}

æ³¨æ„:
- åªèƒ½åˆ é™¤çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
- åˆ é™¤æ“ä½œä¼šå…ˆå°†è¡ŒæçŠ¶æ€æ›´æ–°ä¸º"å·²å–å‡º"ï¼Œç„¶åè¿›è¡Œè½¯åˆ é™¤
- è½¯åˆ é™¤çš„è®°å½•ä¸ä¼šå‡ºç°åœ¨æ™®é€šæŸ¥è¯¢ä¸­ï¼Œä½†ä¼šåŒ…å«åœ¨ç»Ÿè®¡ä¸­
```

### 6. æ›´æ–°è¡Œæ
**PUT** `/employee/update`
```json
è¯·æ±‚ä½“:
{
  "id": 1,                    // å¿…å¡«ï¼šè¡ŒæID
  "status": "å·²å–å‡º",         // å¯é€‰ï¼šè¡ŒæçŠ¶æ€
  "location": "å·²å–å‡º",       // å¯é€‰ï¼šè¡Œæä½ç½®
  "tag": "æ–°æ ‡ç­¾",            // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "weight": 12.5              // å¯é€‰ï¼šè¡Œæé‡é‡
}

æˆåŠŸå“åº”:
{
  "success": true,
  "message": "è¡Œææ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,
    "guest_name": "å¼ ä¸‰",
    "tag": "æ–°æ ‡ç­¾",
    "weight": 12.5,
    "status": "å·²å–å‡º",
    "location": "å·²å–å‡º"
  }
}

å¤±è´¥å“åº”:
- è¡Œæè®°å½•ä¸å­˜åœ¨: {"success": false, "message": "è¡Œæè®°å½•ä¸å­˜åœ¨"}
- æœªæä¾›è¡ŒæID: {"success": false, "message": "è¯·æä¾›è¡ŒæID"}
- æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°: {"success": false, "message": "æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°"}
```

### 7. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å®¢æˆ·å§“åï¼‰
**GET** `/employee/get/name?guest_name=å¼ ä¸‰`
```
è¯·æ±‚å‚æ•°:
- guest_name: å®¢æˆ·å§“åï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    },
    {
      "id": 2,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "é»‘è‰²èƒŒåŒ…",
      "weight": 8.2,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 2
}

æ³¨æ„:
- åªè¿”å›çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
- å·²å–å‡ºçš„è¡Œæä¸ä¼šå‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­
- è¿”å›æ•°æ®å·²æ’é™¤ç³»ç»Ÿæ—¶é—´å­—æ®µï¼ˆcreated_at, updated_at, deleted_atï¼‰
```

### 8. æŸ¥è¯¢æ‰€æœ‰è¡Œæ
**GET** `/employee/get/all`
```
å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    },
    {
      "id": 3,
      "guest_id": 2,
      "guest_name": "æå››",
      "tag": "è“è‰²æ‰‹æç®±",
      "weight": 10.0,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 2
}

æ³¨æ„:
- è¿”å›æ‰€æœ‰çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
- è¿”å›æ•°æ®å·²æ’é™¤ç³»ç»Ÿæ—¶é—´å­—æ®µ
```

### 9. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å®¢æˆ·IDï¼‰
**GET** `/employee/get/guest_id?guest_id=1`
```
è¯·æ±‚å‚æ•°:
- guest_id: å®¢æˆ·IDï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}

æ³¨æ„:
- åªè¿”å›çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
```

### 10. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰å­˜æ”¾ä½ç½®ï¼‰
**GET** `/employee/get/location?location=å‰å°`
```
è¯·æ±‚å‚æ•°:
- location: å­˜æ”¾ä½ç½®ï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}
```

### 11. æŸ¥è¯¢è¡Œæï¼ˆæŒ‰çŠ¶æ€ï¼‰
**GET** `/employee/get/status?status=å¯„å­˜ä¸­`
```
è¯·æ±‚å‚æ•°:
- status: è¡ŒæçŠ¶æ€ï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}
```

### 12. é«˜çº§æŸ¥è¯¢ï¼ˆå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼‰
**POST** `/employee/get/guest_advance`
```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",      // å¯é€‰ï¼šå®¢æˆ·å§“å
  "guest_id": 1,             // å¯é€‰ï¼šå®¢æˆ·ID
  "tag": "çº¢è‰²è¡Œæç®±",        // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "weight": 15.5,            // å¯é€‰ï¼šè¡Œæé‡é‡
  "location": "å‰å°",         // å¯é€‰ï¼šå­˜æ”¾ä½ç½®
  "status": "å¯„å­˜ä¸­"          // å¯é€‰ï¼šè¡ŒæçŠ¶æ€ï¼Œé»˜è®¤ä¸º"å¯„å­˜ä¸­"
}

å“åº”:
{
  "success": true,
  "message": "è·å–è¡ŒææˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 1
}

è¯´æ˜:
- æ”¯æŒå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼Œåªæœ‰éç©ºå­—æ®µæ‰ä¼šä½œä¸ºæŸ¥è¯¢æ¡ä»¶
- å¦‚æœä¸æŒ‡å®šstatusï¼Œé»˜è®¤æŸ¥è¯¢çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
- æ‰€æœ‰æ¡ä»¶éƒ½æ˜¯ANDå…³ç³»
- é€‚ç”¨äºå¤æ‚çš„æœç´¢åœºæ™¯
```

## ğŸ“Š ç»Ÿè®¡åŠŸèƒ½ API (éœ€è¦ç™»å½•)

### 13. è·å–æ€»è¡Œææ•°é‡
**GET** `/employee/count/sum`
```
å“åº”:
{
  "success": true,
  "message": "è¡Œææ•°é‡è·å–æˆåŠŸ",
  "count": 25
}

è¯´æ˜:
- åªç»Ÿè®¡çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œææ•°é‡
- ä¸åŒ…å«å·²å–å‡ºæˆ–å·²åˆ é™¤çš„è¡Œæ
```

### 14. è·å–ä»Šæ—¥è¡Œæç»Ÿè®¡
**GET** `/employee/count/today`
```
å“åº”:
{
  "success": true,
  "message": "è·å–ä»Šæ—¥ç»Ÿè®¡æˆåŠŸ",
  "data": {
    "date": "2025-11-17",
    "today_added": 8,    // ä»Šæ—¥æ–°å¢è¡Œææ•°é‡
    "today_taken": 3      // ä»Šæ—¥å–å‡ºè¡Œææ•°é‡
  }
}

è¯´æ˜:
- today_added: ä»Šæ—¥åˆ›å»ºçš„è¡Œæè®°å½•æ•°é‡
- today_taken: ä»Šæ—¥çŠ¶æ€æ›´æ–°ä¸º"å·²å–å‡º"çš„è¡Œææ•°é‡
- åŒ…å«è½¯åˆ é™¤çš„è®°å½•ç»Ÿè®¡
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### Employee (å‘˜å·¥è¡¨)
```json
{
  "id": 1,
  "user": "zhangsan",
  "password": "123456"
}
```

### Luggage (è¡Œæè¡¨)
```json
{
  "id": 1,
  "guest_id": 1,
  "tag": "çº¢è‰²è¡Œæç®±",
  "weight": 15.5,
  "status": "å¯„å­˜ä¸­",
  "location": "å‰å°"
}
```

### Guest (å®¢æˆ·è¡¨)
```json
{
  "id": 1,
  "name": "å¼ ä¸‰"
}
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **ä¼šè¯ç®¡ç†**: ä½¿ç”¨ Gin Sessions ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€
2. **æƒé™æ§åˆ¶**: è¡Œææ“ä½œéœ€è¦ç™»å½•éªŒè¯
3. **é™æµä¿æŠ¤**: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚

## ğŸ“ˆ çŠ¶æ€ç è¯´æ˜

- `200`: æ“ä½œæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªç™»å½•
- `404`: èµ„æºæœªæ‰¾åˆ°
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸš€ å¯åŠ¨æ–¹å¼

```bash
cd d:\go_study\hotel
# ç¡®ä¿æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®
go run server/main.go
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
hotel/
â”œâ”€â”€ server/main.go          # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ models/struct.go    # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ employee_check/     # å‘˜å·¥è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ employee_action/   # è¡Œææ“ä½œé€»è¾‘
â”‚   â”œâ”€â”€ function/          # é™æµå™¨åŠŸèƒ½
â”‚   â””â”€â”€ table/            # æ•°æ®åº“è¡¨åˆ›å»º
â””â”€â”€ go.mod                # ä¾èµ–ç®¡ç†
```

## ğŸ’¡ ä½¿ç”¨è¯´æ˜

1. å…ˆå¯åŠ¨æœåŠ¡å™¨
2. æ³¨å†Œå‘˜å·¥è´¦å·
3. ç™»å½•è·å–ä¼šè¯
4. è¿›è¡Œè¡Œæç®¡ç†æ“ä½œ

---
æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2025-11-17
é¡¹ç›®ç‰ˆæœ¬: 1.3.0

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v1.3.0 (2025-11-17)
- âœ… æ–°å¢æŒ‰å®¢æˆ·IDæŸ¥è¯¢è¡ŒæåŠŸèƒ½
- âœ… æ–°å¢æŒ‰å­˜æ”¾ä½ç½®æŸ¥è¯¢è¡ŒæåŠŸèƒ½  
- âœ… æ–°å¢æŒ‰çŠ¶æ€æŸ¥è¯¢è¡ŒæåŠŸèƒ½
- âœ… æ–°å¢é«˜çº§å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢åŠŸèƒ½
- âœ… å®Œå–„APIå“åº”çŠ¶æ€ç è¯´æ˜
- âœ… ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘ï¼Œæ”¯æŒåŠ¨æ€æ¡ä»¶æ„å»º

### v1.2.0
- âœ… å®Œå–„åŸºç¡€CRUDåŠŸèƒ½
- âœ… æ·»åŠ ç»Ÿè®¡åŠŸèƒ½
- âœ… å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶