# Hotel è¡Œæç®¡ç†ç³»ç»Ÿ API æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°
é…’åº—è¡Œæç®¡ç†ç³»ç»Ÿï¼Œæä¾›å‘˜å·¥è®¤è¯ã€æƒé™ç®¡ç†å’Œè¡Œæç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒè¡Œæå¯„å­˜ã€å–ä»¶ã€MACåœ°å€è¿½è¸ªç­‰åŠŸèƒ½

## åŸºç¡€ä¿¡æ¯
- **æœåŠ¡å™¨åœ°å€**: http://localhost:8080
- **è®¤è¯æ–¹å¼**: JWT åŒä»¤ç‰Œè®¤è¯ (Access Token + Refresh Token)
- **æƒé™ç³»ç»Ÿ**: RBAC (åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶)
- **é™æµç­–ç•¥**: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¡¶å®¹é‡100ä¸ªä»¤ç‰Œï¼Œæ¯10msè¡¥å……1ä¸ªä»¤ç‰Œ
- **æ•°æ®åº“**: MySQL (studyæ•°æ®åº“)
- **Redis**: å¤šæ•°æ®åº“åˆ†ç¦»å­˜å‚¨ï¼ˆè®¿é—®ä»¤ç‰ŒDB0ã€åˆ·æ–°ä»¤ç‰ŒDB1ã€ç¼“å­˜DB2ã€é™æµDB3ã€éšæœºæ•°DB4ï¼‰
- **å“åº”æ€§èƒ½**: ç™»å½•æ¥å£å¹³å‡å“åº”æ—¶é—´3-10ms

## ğŸ” è®¤è¯ç›¸å…³ API

### 1. å‘˜å·¥ç™»å½•
**POST** `/employee/login`

```json
è¯·æ±‚ä½“:
{
  "hotel_id": 1,              // é…’åº—IDï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º1
  "user": "zhangsan",         // ç”¨æˆ·å
  "password": "123456"        // å¯†ç 
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 900,         // Access Token è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    "token_type": "Bearer"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "æ²¡æœ‰è¿™åå‘˜å·¥"
}

{
  "success": false,
  "message": "ç™»å½•å¤±è´¥"
}

æ³¨æ„:
- æ­¤æ¥å£ä¸éœ€è¦JWTè®¤è¯
- ç™»å½•æˆåŠŸåè¿”å›åŒä»¤ç‰Œ
- æ–°ç”¨æˆ·è‡ªåŠ¨åˆ†é…"å‘˜å·¥"è§’è‰²ï¼ˆrole_id=1ï¼‰
```

### 2. åˆ·æ–°ä»¤ç‰Œ
**POST** `/employee/refresh`

```json
è¯·æ±‚ä½“:
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "tokenåˆ·æ–°æˆåŠŸ",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 900,
    "token_type": "Bearer"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "tokenæ— æ•ˆ"
}

{
  "success": false,
  "message": "å†…éƒ¨é”™è¯¯"
}
```

### 3. å‘˜å·¥é€€å‡º
**POST** `/employee/logout`

```json
è¯·æ±‚å¤´:
Authorization: Bearer <access_token>

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "é€€å‡ºæˆåŠŸ"
}

å¤±è´¥å“åº” (401 Unauthorized):
{
  "success": false,
  "message": "tokenæ— æ•ˆ"
}
```

## ğŸ”§ æƒé™ç®¡ç† API

**æ³¨æ„**: ä»¥ä¸‹æ‰€æœ‰æ¥å£éƒ½éœ€è¦JWTè®¤è¯ + "ç®¡ç†å‘˜"æƒé™

### 4. æ·»åŠ æƒé™
**POST** `/tool/add/permission`

```json
è¯·æ±‚ä½“:
{
  "name": "æŸ¥çœ‹è¡Œæ"          // æƒé™åç§°
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "æ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "æŸ¥çœ‹è¡Œæ",
    "status": "æœ‰æ•ˆ"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "æƒé™å·²å­˜åœ¨"
}

{
  "success": false,
  "message": "å†…éƒ¨é”™è¯¯"
}
```

### 5. æ·»åŠ è§’è‰²
**POST** `/tool/add/role`

```json
è¯·æ±‚ä½“:
{
  "name": "è¡Œæç®¡ç†å‘˜"        // è§’è‰²åç§°
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "æ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "è¡Œæç®¡ç†å‘˜",
    "status": "æœ‰æ•ˆ"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "è§’è‰²å·²å­˜åœ¨"
}
```

### 6. æ·»åŠ è§’è‰²æƒé™å…³è”
**POST** `/tool/add/role_permission`

```json
è¯·æ±‚ä½“:
{
  "role_id": 1,              // è§’è‰²ID
  "permission_id": 1         // æƒé™ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "å…³è”æˆåŠŸ"
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "è§’è‰²ä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "æƒé™ä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "å†…éƒ¨é”™è¯¯"
}
```

### 7. æ›´æ”¹å‘˜å·¥è§’è‰²
**POST** `/tool/change/employee_role`

```json
è¯·æ±‚ä½“:
{
  "employee_id": 1,           // å‘˜å·¥ID
  "role_id": 2                // æ–°è§’è‰²ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è§’è‰²ä¿®æ”¹æˆåŠŸ"
}
```

### 8. å‘˜å·¥æ³¨å†Œï¼ˆç®¡ç†å‘˜æ“ä½œï¼‰
**POST** `/tool/add/employee`

```json
è¯·æ±‚ä½“:
{
  "name": "å¼ ä¸‰",             // å‘˜å·¥å§“å
  "user": "zhangsan",         // ç”¨æˆ·å
  "password": "123456",       // å¯†ç 
  "phone": "13800138000",     // ç”µè¯å·ç 
  "hotel_id": 1               // é…’åº—ID
}

æˆåŠŸå“åº” (201 Created):
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "user": "zhangsan",
    "phone": "13800138000",
    "hotel_id": 1,
    "role_id": 1,
    "status": "æœ‰æ•ˆ"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "ç”¨æˆ·åå·²å­˜åœ¨"
}
```

### 9. æ·»åŠ é…’åº—
**POST** `/tool/add/hotel`

```json
è¯·æ±‚ä½“:
{
  "name": "å¸Œå°”é¡¿é…’åº—",         // é…’åº—åç§°
  "place": "åŒ—äº¬å¸‚æœé˜³åŒº",      // é…’åº—ä½ç½®
  "remark": "äº”æ˜Ÿçº§é…’åº—"        // å¤‡æ³¨ï¼Œå¯é€‰
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "æ·»åŠ æˆåŠŸ",
  "data": {
    "name": "å¸Œå°”é¡¿é…’åº—",
    "place": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "remark": "äº”æ˜Ÿçº§é…’åº—"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "é…’åº—å·²å­˜åœ¨"
}
```

### 10. è·å–æ‰€æœ‰å‘˜å·¥
**GET** `/tool/get/employee`

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "å¼ ä¸‰",
      "user": "zhangsan",
      "phone": "13800138000",
      "hotel_id": 1,
      "role_id": 1,
      "role": {
        "id": 1,
        "name": "å‘˜å·¥",
        "status": "æœ‰æ•ˆ",
        "permissions": [
          {
            "id": 1,
            "name": "åˆ›å»ºè¡Œæ",
            "status": "æœ‰æ•ˆ"
          }
        ]
      }
    }
  ]
}

å¤±è´¥å“åº” (500 Internal Server Error):
{
  "success": false,
  "message": "å†…éƒ¨é”™è¯¯"
}
```

### 11. è·å–æ‰€æœ‰æƒé™
**GET** `/tool/get/permission`

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "åˆ›å»ºè¡Œæ",
      "status": "æœ‰æ•ˆ"
    },
    {
      "id": 2,
      "name": "æŸ¥çœ‹è¡Œæ",
      "status": "æœ‰æ•ˆ"
    },
    {
      "id": 3,
      "name": "æ›´æ–°è¡Œæ",
      "status": "æœ‰æ•ˆ"
    },
    {
      "id": 4,
      "name": "åˆ é™¤è¡Œæ",
      "status": "æœ‰æ•ˆ"
    }
  ]
}
```

### 12. è·å–æ‰€æœ‰è§’è‰²
**GET** `/tool/get/role`

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "å‘˜å·¥",
      "status": "æœ‰æ•ˆ",
      "permissions": [
        {
          "id": 1,
          "name": "åˆ›å»ºè¡Œæ",
          "status": "æœ‰æ•ˆ"
        },
        {
          "id": 2,
          "name": "æŸ¥çœ‹è¡Œæ",
          "status": "æœ‰æ•ˆ"
        }
      ]
    }
  ]
}
```

### 13. åˆ é™¤å‘˜å·¥
**POST** `/tool/delete/employee`

```json
è¯·æ±‚ä½“:
{
  "employee_id": 1            // å‘˜å·¥ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "å†…éƒ¨é”™è¯¯"
}
```

### 14. åˆ é™¤è§’è‰²
**POST** `/tool/delete/role`

```json
è¯·æ±‚ä½“:
{
  "role_id": 1                // è§’è‰²ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

### 15. åˆ é™¤æƒé™
**POST** `/tool/delete/permission`

```json
è¯·æ±‚ä½“:
{
  "permission_id": 1            // æƒé™ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

## ğŸ§³ è¡Œæç®¡ç† API

**æ³¨æ„**: ä»¥ä¸‹æ‰€æœ‰æ¥å£éƒ½éœ€è¦JWTè®¤è¯å’Œç›¸åº”æƒé™

### 16. æ·»åŠ è¡Œæå¯„å­˜
**POST** `/employee/add/luggageStorage`  
**éœ€è¦æƒé™**: "åˆ›å»ºè¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "bag_count": 2,              // è¡Œæè¢‹æ•°é‡
  "backpack_count": 1,         // èƒŒåŒ…æ•°é‡
  "box_count": 3,              // ç®±å­æ•°é‡
  "other_count": 1,            // å…¶ä»–ç‰©å“æ•°é‡
  "guest_name": "å¼ ä¸‰",         // å®¢æˆ·å§“å
  "guest_phone": "13800138000", // å®¢æˆ·ç”µè¯
  "guest_room": "808",          // å®¢æˆ·æˆ¿é—´å·
  "location_id": 1,            // å­˜æ”¾ä½ç½®IDï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º1ï¼ˆå‰å°ï¼‰
  "macs": ["AA:BB:CC:DD:EE:FF", "11:22:33:44:55:66"], // è¡ŒæMACåœ°å€æ•°ç»„ï¼Œå¯é€‰
  "status": "å¯„å­˜ä¸­",          // çŠ¶æ€ï¼Œå¯é€‰ï¼Œé»˜è®¤"å¯„å­˜ä¸­"
  "remark": "æ˜“ç¢å“"            // å¤‡æ³¨ï¼Œå¯é€‰
}

æˆåŠŸå“åº” (201 Created):
{
  "success": true,
  "message": "è¡Œææ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "bag_count": 2,
    "backpack_count": 1,
    "box_count": 3,
    "other_count": 1,
    "guest_id": 1,
    "location_id": 1,
    "operator_id": 1,
    "operator_name": "å¼ ä¸‰",
    "pick_up_code": "ABC123",
    "status": "å¯„å­˜ä¸­",
    "remark": "æ˜“ç¢å“"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "å®¢æˆ·ä¿¡æ¯ä¸èƒ½ä¸ºç©º"
}

{
  "success": false,
  "message": "è¡Œææ•°é‡ä¸èƒ½ä¸º0"
}

{
  "success": false,
  "message": "åˆ›å»ºå®¢æˆ·è®°å½•å¤±è´¥"
}

{
  "success": false,
  "message": "ç”Ÿæˆå–ä»¶ç å¤±è´¥"
}

{
  "success": false,
  "message": "è¡Œæmacä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "åˆ›å»ºè¡Œæè®°å½•å¤±è´¥"
}
```

### 17. æ·»åŠ è¡ŒæMAC
**POST** `/employee/add/mac`  
**éœ€è¦æƒé™**: "åˆ›å»ºè¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "name": "çº¢è‰²è¡Œæç®±",         // æ ‡ç­¾åç§°ï¼Œå¯é€‰
  "mac": "AA:BB:CC:DD:EE:FF"  // MACåœ°å€ï¼Œå¿…å¡«
}

æˆåŠŸå“åº” (201 Created):
{
  "success": true,
  "message": "è¡Œæmacæ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "name": "çº¢è‰²è¡Œæç®±",
    "mac": "AA:BB:CC:DD:EE:FF"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "macä¸èƒ½ä¸ºç©º"
}

{
  "success": false,
  "message": "macå·²å­˜åœ¨"
}

{
  "success": false,
  "message": "åˆ›å»ºè¡Œæmacè®°å½•å¤±è´¥"
}
```

### 18. åˆ é™¤è¡Œæå¯„å­˜
**POST** `/employee/delete/luggageStorage`  
**éœ€è¦æƒé™**: "åˆ é™¤è¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "id": 1                    // å¿…å¡«ï¼šè¡Œæå¯„å­˜ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œæåˆ é™¤æˆåŠŸ"
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "è¡Œæè®°å½•ä¸å­˜åœ¨"
}
```

### 19. æ›´æ–°è¡Œæå­˜å‚¨ä¿¡æ¯
**POST** `/employee/update/luggageStorage`  
**éœ€è¦æƒé™**: "æ›´æ–°è¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "id": 1,                    // å¿…å¡«ï¼šè¡Œæå¯„å­˜ID
  "status": "å·²å–å‡º",         // å¯é€‰ï¼šè¡ŒæçŠ¶æ€
  "location_id": 2,           // å¯é€‰ï¼šå­˜æ”¾ä½ç½®ID
  "remark": "å®¢æˆ·å·²å–èµ°",      // å¯é€‰ï¼šå¤‡æ³¨
  "bag_count": 2,             // å¯é€‰ï¼šè¡ŒæåŒ…æ•°é‡
  "backpack_count": 1,         // å¯é€‰ï¼šèƒŒåŒ…æ•°é‡
  "box_count": 3,             // å¯é€‰ï¼šç®±å­æ•°é‡
  "other_count": 1,            // å¯é€‰ï¼šå…¶ä»–ç‰©å“æ•°é‡
  "guest": {                  // å¯é€‰ï¼šå®¢æˆ·ä¿¡æ¯
    "id": 1,
    "name": "å¼ ä¸‰",
    "gender": "ç”·",
    "phone": "13800138000",
    "id_card": "110101199001011234"
  },
  "location": {               // å¯é€‰ï¼šä½ç½®ä¿¡æ¯
    "id": 2,
    "place": "AåŒº-2å±‚-03å·"
  }
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œææ›´æ–°æˆåŠŸ"
}

è¯·æ±‚ç¤ºä¾‹:
1. åªæ›´æ–°çŠ¶æ€:
```json
{
  "id": 1,
  "status": "å·²å–å‡º"
}
```

2. æ›´æ–°è¡Œææ•°é‡:
```json
{
  "id": 1,
  "bag_count": 2,
  "backpack_count": 1,
  "box_count": 3,
  "other_count": 1
}
```

3. æ›´æ–°å®¢æˆ·ä¿¡æ¯:
```json
{
  "id": 1,
  "guest": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "gender": "ç”·",
    "phone": "13800138000",
    "id_card": "110101199001011234"
  }
}
```

4. æ›´æ–°å­˜å‚¨ä½ç½®:
```json
{
  "id": 1,
  "location": {
    "id": 2,
    "place": "AåŒº-2å±‚-03å·"
  }
}
```
```

### 20. æ›´æ–°è¡Œæä¿¡æ¯
**POST** `/employee/update/luggage`  
**éœ€è¦æƒé™**: "æ›´æ–°è¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "id": 1,                    // å¿…å¡«ï¼šè¡ŒæID
  "status": "å·²å–å‡º",         // å¯é€‰ï¼šè¡ŒæçŠ¶æ€
  "tag": "VIP-001",           // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "mac": "AA:BB:CC:DD:EE:FF", // å¯é€‰ï¼šMACåœ°å€
  "luggage_storage_id": 1     // å¯é€‰ï¼šå…³è”çš„è¡Œæå­˜å‚¨ID
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œææ›´æ–°æˆåŠŸ"
}

è¯·æ±‚ç¤ºä¾‹:
1. åªæ›´æ–°çŠ¶æ€:
```json
{
  "id": 1,
  "status": "å·²å–å‡º"
}
```

2. æ›´æ–°æ ‡ç­¾:
```json
{
  "id": 1,
  "tag": "VIP-001"
}
```

3. æ›´æ–°MACåœ°å€:
```json
{
  "id": 1,
  "mac": "AA:BB:CC:DD:EE:FF"
}
```

4. æ›´æ–°æ‰€æœ‰ä¿¡æ¯:
```json
{
  "id": 1,
  "status": "å·²å–å‡º",
  "tag": "VIP-001",
  "mac": "AA:BB:CC:DD:EE:FF",
  "luggage_storage_id": 1
}
```
```

## ğŸ” è¡ŒææŸ¥è¯¢ API

### 21. æŒ‰å®¢æˆ·å§“åæŸ¥è¯¢
**GET** `/employee/get/name?guest_name=å¼ ä¸‰`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "bag_count": 2,
      "backpack_count": 1,
      "box_count": 3,
      "other_count": 1,
      "guest": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138000",
        "room": "808"
      },
      "location": {
        "id": 1,
        "name": "å‰å°"
      },
      "operator_name": "å¼ ä¸‰",
      "pick_up_code": "ABC123",
      "status": "å¯„å­˜ä¸­",
      "remark": "æ˜“ç¢å“"
    }
  ],
  "count": 1
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·è¾“å…¥å®¢æˆ·å§“å"
}

{
  "success": false,
  "message": "å®¢æˆ·ä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "æŸ¥è¯¢å®¢æˆ·å¤±è´¥"
}

æ³¨æ„: æ”¯æŒç¼“å­˜ï¼Œç›¸åŒæŸ¥è¯¢15åˆ†é’Ÿå†…ä»ç¼“å­˜è¿”å›
```

### 22. æŸ¥è¯¢æ‰€æœ‰è¡Œæ
**GET** `/employee/get/all`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "bag_count": 2,
      "backpack_count": 1,
      "box_count": 3,
      "other_count": 1,
      "guest": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138000",
        "room": "808"
      },
      "location": {
        "id": 1,
        "name": "å‰å°"
      },
      "luggage": [
        {
          "id": 1,
          "tag": {
            "id": 1,
            "name": "çº¢è‰²è¡Œæç®±",
            "mac": "AA:BB:CC:DD:EE:FF"
          },
          "status": "å¯„å­˜ä¸­"
        }
      ],
      "operator_name": "å¼ ä¸‰",
      "pick_up_code": "ABC123",
      "status": "å¯„å­˜ä¸­",
      "remark": "æ˜“ç¢å“"
    }
  ],
  "count": 1
}

æ³¨æ„: åªæŸ¥è¯¢çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
```

### 23. æŒ‰å®¢æˆ·IDæŸ¥è¯¢
**GET** `/employee/get/guest_id?guest_id=1`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "bag_count": 2,
      "backpack_count": 1,
      "box_count": 3,
      "other_count": 1,
      "guest": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138000",
        "room": "808"
      },
      "location": {
        "id": 1,
        "name": "å‰å°"
      },
      "luggage": [
        {
          "id": 1,
          "tag": {
            "id": 1,
            "name": "çº¢è‰²è¡Œæç®±",
            "mac": "AA:BB:CC:DD:EE:FF"
          },
          "status": "å¯„å­˜ä¸­"
        }
      ],
      "operator_name": "å¼ ä¸‰",
      "pick_up_code": "ABC123",
      "status": "å¯„å­˜ä¸­",
      "remark": "æ˜“ç¢å“"
    }
  ],
  "count": 1
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·è¾“å…¥å®¢æˆ·ID"
}

{
  "success": false,
  "message": "æœªæ‰¾åˆ°è¯¥å®¢æˆ·çš„è¡Œæ"
}

æ³¨æ„: æ”¯æŒç¼“å­˜ï¼Œç›¸åŒæŸ¥è¯¢15åˆ†é’Ÿå†…ä»ç¼“å­˜è¿”å›
```

### 24. æŒ‰å­˜æ”¾ä½ç½®æŸ¥è¯¢
**GET** `/employee/get/location?location=å‰å°`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–è¡ŒææˆåŠŸ",
  "data": [
    {
      "id": 1,
      "bag_count": 2,
      "backpack_count": 1,
      "box_count": 3,
      "other_count": 1,
      "guest": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138000",
        "room": "808"
      },
      "operator_name": "å¼ ä¸‰",
      "pick_up_code": "ABC123",
      "status": "å¯„å­˜ä¸­",
      "remark": "æ˜“ç¢å“"
    }
  ],
  "count": 1
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·è¾“å…¥å­˜æ”¾åœ°ç‚¹"
}

{
  "success": false,
  "message": "å­˜æ”¾åœ°ç‚¹ä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "è·å–å­˜æ”¾åœ°ç‚¹å¤±è´¥"
}
```

### 25. é«˜çº§æŸ¥è¯¢ï¼ˆå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼‰
**POST** `/employee/get/guest_advance`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",        // å¯é€‰ï¼šå®¢æˆ·å§“å
  "location_name": "å‰å°",      // å¯é€‰ï¼šå­˜æ”¾ä½ç½®åç§°
  "operator_name": "å¼ ä¸‰",      // å¯é€‰ï¼šæ“ä½œå‘˜å§“å
  "status": "å¯„å­˜ä¸­"           // å¯é€‰ï¼šè¡ŒæçŠ¶æ€ï¼Œé»˜è®¤ä¸º"å¯„å­˜ä¸­"
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–è¡ŒææˆåŠŸ",
  "data": [
    {
      "id": 1,
      "bag_count": 2,
      "backpack_count": 1,
      "box_count": 3,
      "other_count": 1,
      "guest": {
        "id": 1,
        "name": "å¼ ä¸‰",
        "phone": "13800138000",
        "room": "808"
      },
      "location": {
        "id": 1,
        "name": "å‰å°"
      },
      "operator_name": "å¼ ä¸‰",
      "pick_up_code": "ABC123",
      "status": "å¯„å­˜ä¸­",
      "remark": "æ˜“ç¢å“"
    }
  ],
  "count": 1
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯"
}

{
  "success": false,
  "message": "è·å–è¡Œæå¤±è´¥"
}

{
  "success": false,
  "message": "æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è¡Œæ"
}
```

### 26. æŒ‰å–ä»¶ç æŸ¥è¯¢
**POST** `/employee/get/pick_up_code`  
**éœ€è¦æƒé™**: "æŸ¥çœ‹è¡Œæ"

```json
è¯·æ±‚ä½“:
{
  "pick_up_code": "ABC123"     // å–ä»¶ç 
}

æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "bag_count": 2,
    "backpack_count": 1,
    "box_count": 3,
    "other_count": 1,
    "guest": {
      "id": 1,
      "name": "å¼ ä¸‰",
      "phone": "13800138000",
      "room": "808"
    },
    "location": {
      "id": 1,
      "name": "å‰å°"
    },
    "luggage": [
      {
        "id": 1,
        "tag": {
          "id": 1,
          "name": "çº¢è‰²è¡Œæç®±",
          "mac": "AA:BB:CC:DD:EE:FF"
        },
        "status": "å¯„å­˜ä¸­"
      }
    ],
    "operator_name": "å¼ ä¸‰",
    "pick_up_code": "ABC123",
    "status": "å¯„å­˜ä¸­",
    "remark": "æ˜“ç¢å“"
  }
}

å¤±è´¥å“åº”ç¤ºä¾‹:
{
  "success": false,
  "message": "è¡Œææ•°æ®ç»‘å®šé”™è¯¯"
}

{
  "success": false,
  "message": "è¡Œæè®°å½•ä¸å­˜åœ¨"
}

{
  "success": false,
  "message": "æŸ¥è¯¢è¡Œæå¤±è´¥"
}
```

## ğŸ“Š ç»Ÿè®¡åŠŸèƒ½ API

**æ³¨æ„**: ç»Ÿè®¡åŠŸèƒ½åªéœ€è¦JWTè®¤è¯ï¼Œæ— éœ€ç‰¹å®šæƒé™

### 27. è·å–æ€»è¡Œææ•°é‡
**GET** `/employee/count/sum`

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è¡Œææ•°é‡è·å–æˆåŠŸ",
  "count": 25
}

å¤±è´¥å“åº” (500 Internal Server Error):
{
  "success": false,
  "message": "è·å–è¡Œææ•°é‡å¤±è´¥"
}
```

### 28. è·å–ä»Šæ—¥è¡Œæç»Ÿè®¡
**GET** `/employee/count/today`

```json
æˆåŠŸå“åº” (200 OK):
{
  "success": true,
  "message": "è·å–ä»Šæ—¥ç»Ÿè®¡æˆåŠŸ",
  "data": {
    "date": "2025-12-16",
    "today_added": 8,    // ä»Šæ—¥æ–°å¢è¡Œææ•°é‡
    "today_taken": 3      // ä»Šæ—¥å–å‡ºè¡Œææ•°é‡
  }
}

å¤±è´¥å“åº” (500 Internal Server Error):
{
  "success": false,
  "message": "è·å–ä»Šæ—¥ç»Ÿè®¡å¤±è´¥"
}
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### Employee (å‘˜å·¥è¡¨)
```json
{
  "id": 1,
  "name": "å¼ ä¸‰",
  "user": "zhangsan",
  "password": "encrypted_password",
  "phone": "13800138000",
  "status": "æœ‰æ•ˆ",
  "last_active_time": "2025-12-16T10:30:00Z",
  "hotel_id": 1,
  "role_id": 1,
  "hotel": {
    "id": 1,
    "name": "å¸Œå°”é¡¿é…’åº—",
    "place": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "remark": "äº”æ˜Ÿçº§é…’åº—"
  },
  "role": {
    "id": 1,
    "name": "å‘˜å·¥",
    "status": "æœ‰æ•ˆ"
  }
}
```

### Role (è§’è‰²è¡¨)
```json
{
  "id": 1,
  "name": "å‘˜å·¥",
  "status": "æœ‰æ•ˆ",
  "permissions": [
    {
      "id": 1,
      "name": "åˆ›å»ºè¡Œæ",
      "status": "æœ‰æ•ˆ"
    }
  ]
}
```

### Permission (æƒé™è¡¨)
```json
{
  "id": 1,
  "name": "åˆ›å»ºè¡Œæ",
  "status": "æœ‰æ•ˆ"
}
```

### LuggageStorage (è¡Œæå¯„å­˜è¡¨)
```json
{
  "id": 1,
  "bag_count": 2,
  "backpack_count": 1,
  "box_count": 3,
  "other_count": 1,
  "operator_id": 1,
  "operator_name": "å¼ ä¸‰",
  "location_id": 1,
  "hotel_id": 1,
  "guest_id": 1,
  "luggage": [
    {
      "id": 1,
      "status": "å¯„å­˜ä¸­",
      "luggage_storage_id": 1,
      "tag_id": 1,
      "tag": {
        "id": 1,
        "name": "çº¢è‰²è¡Œæç®±",
        "mac": "AA:BB:CC:DD:EE:FF"
      }
    }
  ],
  "pick_up_code": "ABC123",
  "status": "å¯„å­˜ä¸­",
  "remark": "æ˜“ç¢å“",
  "location": {
    "id": 1,
    "name": "å‰å°",
    "status": "æœ‰æ•ˆ"
  },
  "guest": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "phone": "13800138000",
    "room": "808"
  }
}
```

### Luggage (è¡Œæè¡¨)
```json
{
  "id": 1,
  "status": "å¯„å­˜ä¸­",
  "luggage_storage_id": 1,
  "tag_id": 1,
  "luggage_storage": {
    "id": 1,
    "bag_count": 2,
    "status": "å¯„å­˜ä¸­"
  },
  "tag": {
    "id": 1,
    "name": "çº¢è‰²è¡Œæç®±",
    "mac": "AA:BB:CC:DD:EE:FF"
  }
}
```

### Tag (æ ‡ç­¾è¡¨)
```json
{
  "id": 1,
  "name": "çº¢è‰²è¡Œæç®±",
  "mac": "AA:BB:CC:DD:EE:FF"
}
```

### Location (ä½ç½®è¡¨)
```json
{
  "id": 1,
  "name": "å‰å°",
  "status": "æœ‰æ•ˆ",
  "hotel_id": 1,
  "luggage": [
    {
      "id": 1,
      "bag_count": 2,
      "status": "å¯„å­˜ä¸­"
    }
  ],
  "hotel": {
    "id": 1,
    "name": "å¸Œå°”é¡¿é…’åº—",
    "place": "åŒ—äº¬å¸‚æœé˜³åŒº"
  }
}
```

### Guest (å®¢æˆ·è¡¨)
```json
{
  "id": 1,
  "name": "å¼ ä¸‰",
  "phone": "13800138000",
  "room": "808",
  "luggage": [
    {
      "id": 1,
      "bag_count": 2,
      "status": "å¯„å­˜ä¸­"
    }
  ]
}
```

### Hotel (é…’åº—è¡¨)
```json
{
  "id": 1,
  "name": "å¸Œå°”é¡¿é…’åº—",
  "status": "æœ‰æ•ˆ",
  "place": "åŒ—äº¬å¸‚æœé˜³åŒº",
  "remark": "äº”æ˜Ÿçº§é…’åº—"
}
```

## ğŸ”’ æƒé™ç³»ç»Ÿè®¾è®¡

### RBACæƒé™æ¨¡å‹
1. **ç”¨æˆ·(User)** â†’ **è§’è‰²(Role)**: ä¸€å¯¹å¤šå…³ç³»
2. **è§’è‰²(Role)** â†’ **æƒé™(Permission)**: å¤šå¯¹å¤šå…³ç³»

### é»˜è®¤è§’è‰²å’Œæƒé™
- **å‘˜å·¥**: åˆ›å»ºè¡Œæã€æŸ¥çœ‹è¡Œæã€æ›´æ–°è¡Œæã€åˆ é™¤è¡Œæ
- **ç®¡ç†å‘˜**: ç®¡ç†å‘˜æƒé™ï¼ˆåŒ…å«æ‰€æœ‰å‘˜å·¥æƒé™ + ç”¨æˆ·ç®¡ç†æƒé™ï¼‰

### æƒé™åˆ—è¡¨
1. **åˆ›å»ºè¡Œæ** - æ·»åŠ è¡Œæå¯„å­˜è®°å½•å’ŒMACæ ‡ç­¾
2. **æŸ¥çœ‹è¡Œæ** - æŸ¥è¯¢æ‰€æœ‰è¡Œæç›¸å…³ä¿¡æ¯
3. **æ›´æ–°è¡Œæ** - ä¿®æ”¹è¡ŒæçŠ¶æ€å’Œä¿¡æ¯
4. **åˆ é™¤è¡Œæ** - åˆ é™¤è¡Œæå¯„å­˜è®°å½•
5. **ç®¡ç†å‘˜** - ç”¨æˆ·å’Œæƒé™ç®¡ç†

### æƒé™æ£€æŸ¥æµç¨‹
1. JwtCheck() éªŒè¯JWTä»¤ç‰Œ
2. AuthCheck() åŠ è½½ç”¨æˆ·æƒé™åˆ°ä¸Šä¸‹æ–‡  
3. CheckAction() æ£€æŸ¥ç‰¹å®šæƒé™
4. æƒé™é€šè¿‡åˆ™æ‰§è¡Œä¸šåŠ¡é€»è¾‘

## âš¡ é™æµé…ç½®

- **ä»¤ç‰Œæ¡¶å®¹é‡**: 100ä¸ªä»¤ç‰Œ
- **è¡¥å……é€Ÿç‡**: æ¯10msè¡¥å……1ä¸ªä»¤ç‰Œ
- **æ¯ä¸ªè¯·æ±‚**: æ¶ˆè€—1ä¸ªä»¤ç‰Œ
- **è¶…å‡ºé™åˆ¶**: è¿”å›429çŠ¶æ€ç 
- **é”æœºåˆ¶**: Redisåˆ†å¸ƒå¼é”ï¼Œé”è¶…æ—¶100ms

## ğŸ“ˆ çŠ¶æ€ç è¯´æ˜

- `200`: æ“ä½œæˆåŠŸ
- `201`: åˆ›å»ºæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªè®¤è¯æˆ–ä»¤ç‰Œæ— æ•ˆ/è¿‡æœŸ
- `403`: æƒé™ä¸è¶³
- `404`: èµ„æºæœªæ‰¾åˆ°
- `409`: èµ„æºå†²çªï¼ˆå¦‚ç”¨æˆ·åå·²å­˜åœ¨ï¼‰
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸš€ å¯åŠ¨æ–¹å¼

```bash
cd c:/Users/å‚…ä»æ°/Desktop/hotel
go run api/main.go
```

æœåŠ¡å™¨å°†åœ¨ `http://0.0.0.0:8080` å¯åŠ¨

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½® (configs/dev.yaml)
```yaml
database:
  driver: mysql
  host: 127.0.0.1
  port: 3306
  username: root
  password: "@furenjie321"
  name: study
  charset: utf8mb4
  parse_time: true
  loc: Local
```

### Redisé…ç½®
```yaml
redis:
  host: 127.0.0.1
  port: 6379
  password: ""
  databases:
    access_token: 0    # è®¿é—®ä»¤ç‰Œ
    refresh_token: 1   # åˆ·æ–°ä»¤ç‰Œ
    cache: 2           # ç¼“å­˜
    rate_limit: 3      # é™æµ
    random: 4          # éšæœºæ•°
```

### JWTé…ç½®
```yaml
jwt:
  secret_key: "your-super-secret-jwt-key-change-in-production"
  access_token_duration: 900s    # 15åˆ†é’Ÿ
  refresh_token_duration: 604800s # 7å¤©
```

### ç³»ç»Ÿæ—¥å¿—ç¤ºä¾‹
```
2025/12/16 10:30:52 local é™æµå™¨ 95
[GIN] 2025/12/16 - 10:30:52 | 200 |      7.3677ms |             ::1 | POST     "/employee/login"
```

## ğŸ”„ ç¼“å­˜ç­–ç•¥

- **æŸ¥è¯¢ç¼“å­˜**: å®¢æˆ·å§“åã€å®¢æˆ·IDæŸ¥è¯¢ç»“æœç¼“å­˜15åˆ†é’Ÿ
- **ä»¤ç‰Œå­˜å‚¨**: Access Tokenå­˜å‚¨15åˆ†é’Ÿï¼ŒRefresh Tokenå­˜å‚¨7å¤©
- **é™æµç¼“å­˜**: é™æµçŠ¶æ€å®æ—¶å­˜å‚¨

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è®¤è¯**: é™¤ç™»å½•å’Œåˆ·æ–°ä»¤ç‰Œæ¥å£å¤–ï¼Œæ‰€æœ‰æ¥å£éƒ½éœ€è¦JWTè®¤è¯
2. **æƒé™**: éƒ¨åˆ†æ¥å£éœ€è¦ç‰¹å®šæƒé™ï¼Œå¦‚ç®¡ç†å‘˜æ¥å£éœ€è¦"ç®¡ç†å‘˜"æƒé™
3. **è½¯åˆ é™¤**: æ‰€æœ‰ä¸»è¦æ•°æ®è¡¨æ”¯æŒè½¯åˆ é™¤ï¼ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è¿‡æ»¤å·²åˆ é™¤è®°å½•
4. **å–ä»¶ç **: ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€å–ä»¶ç ï¼Œæ”¯æŒæŒ‰å–ä»¶ç æŸ¥è¯¢è¡Œæ
5. **MACè¿½è¸ª**: æ”¯æŒä¸ºæ¯ä¸ªè¡Œææ·»åŠ MACåœ°å€æ ‡ç­¾ï¼Œä¾¿äºè¿½è¸ªç®¡ç†
6. **å¤šé…’åº—æ”¯æŒ**: ç³»ç»Ÿæ”¯æŒå¤šé…’åº—ç®¡ç†ï¼Œæ¯ä¸ªå‘˜å·¥ç»‘å®šåˆ°ç‰¹å®šé…’åº—

---
æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2025-12-16  
é¡¹ç›®ç‰ˆæœ¬: 3.0.0