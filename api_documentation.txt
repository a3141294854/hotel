# Hotel ç®¡ç†ç³»ç»Ÿ API æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°
é…’åº—è¡Œæç®¡ç†ç³»ç»Ÿï¼Œæä¾›å‘˜å·¥è®¤è¯å’Œè¡Œæç®¡ç†åŠŸèƒ½

## åŸºç¡€ä¿¡æ¯
- æœåŠ¡å™¨åœ°å€: http://localhost:8080
- è®¤è¯æ–¹å¼: Session ä¼šè¯ç®¡ç†
- é™æµç­–ç•¥: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚

## ğŸ” è®¤è¯ç›¸å…³ API

### 1. å‘˜å·¥æ³¨å†Œ
**POST** `/employee/register`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan",    // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
  "password": "123456"
}

å“åº”:
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

### 2. å‘˜å·¥ç™»å½•
**POST** `/employee/login`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan",     // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
  "password": "123456"
}

å“åº”:
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ"
}

å¤±è´¥å“åº”:
{
  "success": false,
  "message": "æ²¡æœ‰è¿™åå‘˜å·¥" æˆ– "ç™»å½•å¤±è´¥"
}
```

### 3. å‘˜å·¥é€€å‡º
**POST** `/employee/logout`
```json
è¯·æ±‚ä½“:
{
  "user_name": "zhangsan"      // æ³¨æ„ï¼šå­—æ®µåæ˜¯ user_name
}

å“åº”:
{
  "success": true,
  "message": "é€€å‡ºæˆåŠŸ"
}
```

## ğŸ§³ è¡Œæç®¡ç† API (éœ€è¦ç™»å½•)

### 4. æ·»åŠ è¡Œæ
**POST** `/employee/add`
```json
è¯·æ±‚ä½“:
{
  "guest_name": "å¼ ä¸‰",      // å®¢æˆ·å§“åï¼ˆç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºå®¢æˆ·è®°å½•ï¼‰
  "tag": "çº¢è‰²è¡Œæç®±",        // å¿…å¡«ï¼šè¡Œææ ‡ç­¾
  "weight": 15.5,           // å¯é€‰ï¼šè¡Œæé‡é‡
  "status": "å¯„å­˜ä¸­",        // å¯é€‰ï¼Œé»˜è®¤"å¯„å­˜ä¸­"
  "location": "å‰å°"         // å¯é€‰ï¼Œé»˜è®¤"å‰å°"
}

å“åº”:
{
  "success": true,
  "message": "è¡Œææ·»åŠ æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,           // ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å®¢æˆ·ID
    "guest_name": "å¼ ä¸‰",
    "tag": "çº¢è‰²è¡Œæç®±",
    "weight": 15.5,
    "status": "å¯„å­˜ä¸­",
    "location": "å‰å°"
  }
}
```

### 5. åˆ é™¤è¡Œæ
**DELETE** `/employee/delete`
```json
è¯·æ±‚ä½“:
{
  "id": 1
}

å“åº”:
{
  "success": true,
  "message": "è¡Œæåˆ é™¤æˆåŠŸ"
}

æ³¨æ„:
- åªèƒ½åˆ é™¤çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæ
- åˆ é™¤æ“ä½œä¼šå…ˆå°†è¡ŒæçŠ¶æ€æ›´æ–°ä¸º"å·²å–å‡º"ï¼Œç„¶åè¿›è¡Œè½¯åˆ é™¤
- è½¯åˆ é™¤çš„è®°å½•ä¸ä¼šå‡ºç°åœ¨æ™®é€šæŸ¥è¯¢ä¸­ï¼Œä½†ä¼šåŒ…å«åœ¨ç»Ÿè®¡ä¸­
```

### 6. æ›´æ–°è¡Œæ
**PUT** `/employee/update`
```json
è¯·æ±‚ä½“:
{
  "id": 1,                    // å¿…å¡«ï¼šè¡ŒæID
  "status": "å·²å–å‡º",         // å¯é€‰ï¼šè¡ŒæçŠ¶æ€
  "location": "å·²å–å‡º",       // å¯é€‰ï¼šè¡Œæä½ç½®
  "tag": "æ–°æ ‡ç­¾",            // å¯é€‰ï¼šè¡Œææ ‡ç­¾
  "weight": 12.5              // å¯é€‰ï¼šè¡Œæé‡é‡
}

æˆåŠŸå“åº”:
{
  "success": true,
  "message": "è¡Œææ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "guest_id": 1,
    "guest_name": "å¼ ä¸‰",
    "tag": "æ–°æ ‡ç­¾",
    "weight": 12.5,
    "status": "å·²å–å‡º",
    "location": "å·²å–å‡º"
  }
}

å¤±è´¥å“åº”:
- è¡Œæè®°å½•ä¸å­˜åœ¨: {"success": false, "message": "è¡Œæè®°å½•ä¸å­˜åœ¨"}
- æœªæä¾›è¡ŒæID: {"success": false, "message": "è¯·æä¾›è¡ŒæID"}
- æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°: {"success": false, "message": "æ²¡æœ‰æ•°æ®éœ€è¦æ›´æ–°"}
```

### 7. æŸ¥è¯¢è¡Œæ
**GET** `/employee/get?guest_name=å¼ ä¸‰`
```
è¯·æ±‚å‚æ•°:
- guest_name: å®¢æˆ·å§“åï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "message": "è¡Œæè·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "çº¢è‰²è¡Œæç®±",
      "weight": 15.5,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    },
    {
      "id": 2,
      "guest_id": 1,
      "guest_name": "å¼ ä¸‰",
      "tag": "é»‘è‰²èƒŒåŒ…",
      "weight": 8.2,
      "status": "å¯„å­˜ä¸­",
      "location": "å‰å°"
    }
  ],
  "count": 2
}

æ³¨æ„:
- åªè¿”å›çŠ¶æ€ä¸º"å¯„å­˜ä¸­"çš„è¡Œæè®°å½•
- å·²å–å‡ºçš„è¡Œæä¸ä¼šå‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­
```

## ğŸ“Š ç»Ÿè®¡åŠŸèƒ½ API (éœ€è¦ç™»å½•)

### 8. è·å–æ€»è¡Œææ•°é‡
**GET** `/employee/count/sum`
```
å“åº”:
{
  "success": true,
  "message": "è¡Œææ•°é‡è·å–æˆåŠŸ",
  "count": 25
}
```

### 9. è·å–ä»Šæ—¥è¡Œæç»Ÿè®¡
**GET** `/employee/count/today`
```
å“åº”:
{
  "success": true,
  "message": "è·å–ä»Šæ—¥ç»Ÿè®¡æˆåŠŸ",
  "data": {
    "date": "2025-11-17",
    "today_added": 8,    // ä»Šæ—¥æ–°å¢è¡Œææ•°é‡
    "today_taken": 3      // ä»Šæ—¥å–å‡ºè¡Œææ•°é‡
  }
}
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### Employee (å‘˜å·¥è¡¨)
```json
{
  "id": 1,
  "user": "zhangsan",
  "password": "123456"
}
```

### Luggage (è¡Œæè¡¨)
```json
{
  "id": 1,
  "guest_id": 1,
  "tag": "çº¢è‰²è¡Œæç®±",
  "weight": 15.5,
  "status": "å¯„å­˜ä¸­",
  "location": "å‰å°"
}
```

### Guest (å®¢æˆ·è¡¨)
```json
{
  "id": 1,
  "name": "å¼ ä¸‰"
}
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **ä¼šè¯ç®¡ç†**: ä½¿ç”¨ Gin Sessions ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€
2. **æƒé™æ§åˆ¶**: è¡Œææ“ä½œéœ€è¦ç™»å½•éªŒè¯
3. **é™æµä¿æŠ¤**: ä»¤ç‰Œæ¡¶é™æµï¼Œæ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚

## ğŸ“ˆ çŠ¶æ€ç è¯´æ˜

- `200`: æ“ä½œæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªç™»å½•
- `429`: è¯·æ±‚è¿‡äºé¢‘ç¹
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸš€ å¯åŠ¨æ–¹å¼

```bash
cd d:\go_study\hotel
# ç¡®ä¿æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®
go run server/main.go
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
hotel/
â”œâ”€â”€ server/main.go          # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ models/struct.go    # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ employee_check/     # å‘˜å·¥è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ employee_action/   # è¡Œææ“ä½œé€»è¾‘
â”‚   â”œâ”€â”€ function/          # é™æµå™¨åŠŸèƒ½
â”‚   â””â”€â”€ table/            # æ•°æ®åº“è¡¨åˆ›å»º
â””â”€â”€ go.mod                # ä¾èµ–ç®¡ç†
```

## ğŸ’¡ ä½¿ç”¨è¯´æ˜

1. å…ˆå¯åŠ¨æœåŠ¡å™¨
2. æ³¨å†Œå‘˜å·¥è´¦å·
3. ç™»å½•è·å–ä¼šè¯
4. è¿›è¡Œè¡Œæç®¡ç†æ“ä½œ

---
æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2025-11-17
é¡¹ç›®ç‰ˆæœ¬: 1.1.0